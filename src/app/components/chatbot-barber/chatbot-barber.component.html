<!-- BotÃ³n flotante -->
<div class="chat-fab" (click)="toggleChat()">
    @if(!isOpen){
        <span>ğŸ’¬</span>

    }@else{
        <span >âœ•</span>

    }
  </div>
  
  <!-- Ventana del chat -->
  <div class="chat-window" [class.open]="isOpen">
  
    <!-- Header -->
    <div class="chat-header">
      <div class="chat-header-info">
        <div class="chat-avatar">âœ‚ï¸</div>
        <div>
          <div class="chat-title">HairBooking</div>
          <div class="chat-subtitle">{{ getText('Asistente virtual', 'Virtual Assistant') }}</div>
        </div>
      </div>
      <button class="chat-close" (click)="toggleChat()">âœ•</button>
    </div>
  
    <!-- Mensajes -->
    <div class="chat-messages" #messagesContainer>
        @for(msg of messages; track msg){
      <div
        class="message"
        [class.user]="msg.role === 'user'"
        [class.assistant]="msg.role === 'assistant'"
      >
        <div class="message-bubble">{{ msg.content }}</div>
      </div>
    }
  
      <!-- Typing indicator -->
       @if(isLoading){
        <div class="message assistant">
            <div class="message-bubble typing">
              <span></span><span></span><span></span>
            </div>
          </div>
       }
      
    </div>
  
    <!-- Input -->
    <div class="chat-input-area">
      <textarea
        [(ngModel)]="userInput"
        (keydown)="onKeyPress($event)"
        [placeholder]="getText('Escribe un mensaje...', 'Type a message...')"
        rows="1"
        [disabled]="isLoading"
      ></textarea>
      <button (click)="sendMessage()" [disabled]="isLoading || !userInput.trim()">
        â¤
      </button>
    </div>
  
  </div>